# ============================================

# FORZAR HTTPS

# ============================================

RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.\*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# ============================================

# PROTEGER ARCHIVOS SENSIBLES

# ============================================

<FilesMatch "\.(env|py|pyc|pyo|log|db|sqlite|txt|md|sh)$">
Require all denied
</FilesMatch>

# Bloquear acceso a directorios

RedirectMatch 403 ^/\.git
RedirectMatch 403 ^/venv
RedirectMatch 403 ^/\.venv
RedirectMatch 403 ^/scripts
RedirectMatch 403 ^/**pycache**
RedirectMatch 403 ^/tests
RedirectMatch 403 ^/docs

# ============================================

# HEADERS DE SEGURIDAD

# ============================================

<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# ============================================

# PREVENIR DIRECTORY LISTING

# ============================================

Options -Indexes

# ============================================

# PROTECCIÃ“N CONTRA HOTLINKING

# ============================================

RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?familiones.com [NC]
RewriteRule \.(jpg|jpeg|png|gif|svg)$ - [NC,F,L]
